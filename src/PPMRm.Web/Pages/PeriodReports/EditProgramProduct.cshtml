@page "/PeriodReports/Edit/{periodReportId}/programs/{programId:int}/products/{id?}"
@model PPMRm.Web.Pages.PeriodReports.EditProgramProductModel
@using PPMRm.PeriodReports
@using Volo.Abp.AspNetCore.Mvc.UI.Bootstrap.TagHelpers.Modal
@{
}

<abp-dynamic-form abp-model="Product" data-check-form-on-close="false">
    <fieldset @(Model.IsReadonly ? "disabled" : "")>
        <abp-form-content />
    </fieldset>
</abp-dynamic-form>
<table class="table">
    <thead>
    <tr>
    <th>Supplier</th>
    <th>Next Shipment Date</th>
    <th>Quantity</th>
    <th>Shipment MOS</th>
    <th>Data Source</th>
    <th></th>
    </tr>
    </thead>
    <tbody>
        @if(Model.Product.Shipments != null && Model.Product.Shipments.Any())
        {
            @foreach(var s in Model.Product.Shipments?.OrderBy(l => l.ShipmentDate))
    {
        <tr>
            <td>@s.Supplier</td>
            <td>@s.ShipmentDate?.ToString(PeriodReportConsts.DataFormatting.DateFormat) @s.ShipmentDateType</td>
            <td>@s.Quantity.ToString(PeriodReportConsts.DataFormatting.SOH_AMC_Format)</td>
            <td>@s.MOS?.ToString(PeriodReportConsts.DataFormatting.MOS_Format)</td>
            <td>@s.DataSource</td>
            <td>
            <abp-row>
                <abp-column size-md="_6">
                                                        
                </abp-column>
                <abp-column size-md="_6">
                @if(!Model.IsReadonly)
                {
                <abp-button data-id="@s.Id" data-product-id="@s.ProductId" data-program-id="@Model.Product.ProgramId" data-period-report-id="" data-shipment-id="@s.Id"
                            class="btn-edit-shipment btn-sm @(Model.IsReadonly ? "disabled" : "")"
                            icon="pencil"
                            text=""
                            button-type="Warning"/>
                <abp-button data-id="@s.Id" data-product-id="@s.ProductId" data-program-id="@Model.Product.ProgramId" data-period-report-id=""
                            class="btn-remove-shipment btn-sm @(Model.IsReadonly ? "disabled" : "")"
                            icon="minus"
                            text=""
                            button-type="Danger"/>
                }
                </abp-column>
            </abp-row>
            </td>
        </tr>
    }
    <tr>
        <td class="text-right" colspan="6">
        @if(!Model.IsReadonly)
    {
    <abp-button data-product-id="" data-program-id="" data-period-report-id=""
                            class="btn-add-shipment btn-sm @(Model.IsReadonly ? "disabled" : "")"
                            icon="plus"
                            text="Add Shipment"
                            button-type="Success"/>
    }
            </td>
    </tr>
            
        }
        
</tbody>
</table>